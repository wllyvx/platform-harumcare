---
interface Props {
  _id: string;
  title: string;
  content: string;
  image: string;
  slug: string;
  author?: {
    nama: string;
    username: string;
  };
  category: string;
  createdAt: string;
  viewCount: number;
}

const { 
  _id, 
  title, 
  content, 
  image, 
  slug, 
  author, 
  category, 
  createdAt, 
  viewCount 
} = Astro.props;

// Format tanggal
const formatDate = (dateString: string) => {
  const date = new Date(dateString);
  return date.toLocaleDateString('id-ID', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
};

// Truncate content untuk preview
const truncateContent = (text: string, maxLength: number = 100) => {
  if (text.length <= maxLength) return text;
  return text.substring(0, maxLength) + '...';
};
---

<div class="news-card bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-300">
     <div class="news-image">
     <img 
       src={image || "/images/empty-image-placeholder.webp"} 
       alt={title}
       class="w-full h-48 object-cover"
       onerror="console.error('Failed to load image:', this.src)"
     />
   </div>
  <div class="news-content p-4">
    <div class="news-meta flex items-center gap-2 mb-2">
      <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full font-medium">
        {category}
      </span>
      <span class="text-xs text-gray-500">
        {formatDate(createdAt)}
      </span>
    </div>
    
    <h3 class="text-lg font-bold text-gray-900 mb-2 line-clamp-2">
      {title}
    </h3>
    
    <p class="text-sm text-gray-600 mb-3 line-clamp-3">
      {truncateContent(content)}
    </p>
    
    <div class="news-footer flex items-center justify-between">
      <div class="author-info flex items-center gap-2">
        <img 
          src="/images/icons/user-default.svg" 
          alt="Author" 
          class="w-6 h-6 rounded-full"
        />
        <span class="text-xs text-gray-500">
          {author?.nama || 'Anonymous'}
        </span>
      </div>
      
      <div class="view-count text-xs text-gray-500">
        {viewCount} dilihat
      </div>
    </div>
    
    <a 
      href={`/news/${slug}`}
      class="mt-4 inline-block bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700 transition-colors duration-300 w-full text-center"
    >
      Baca Selengkapnya
    </a>
  </div>
</div>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>